@startuml
' hide the spot
hide circle

' avoid problems with angled crows feet
skinparam linetype ortho

entity "User" as user {
  *_id : string <<generated>>
  --
  *email : text
  *password : text
  *firstName : text
  *lastName: text
  *services : { G+, FB }
  *role : enum
  *picture : text
  *invitedBy: text <<FK>>
  *nReviews: number
}

entity "Invitation" as inv {
  *_id : string <<generated>>
  --
  *invitedBy : text <<FK>>
  *invitedEmail: text
  *createdAt: date
  *verificationCode: Number
  *isValid: Boolean
  --
  - TTL 48 hours
}

entity "Rating" as rating {
  *_id : string <<generated>>
  --
  *ratedBy : text <<FK>>
  --
  One of following is required
  --
  *userId: text <<FK>>
  *articleId: text <<FK>>
  *claimId: text <<FK>>
  *reviewId: text <<FK>>
  --
  *text: Text
  *rating: Number {-1..10}
  *createdAt: date
}

entity "Article" as article {
  *_id : text <<generated>>
  --
  *claims: [<<FK>>,...]
  *addedBy : text <<FK>>
  *text : text
  *sourceUrl: text
  *sourceType : enum
  *language : text
}

entity "Claim" as claim {
  *_id : text <<generated>>
  --
  *articles: [<<FK>>,...]
  *priority: number
  *addedBy: text <<FK>>
  *articleId : text <<FK>>
  *text : text
}

entity "Review" as review {
  *_id : text <<generated>>
  --
  *userId : text <<FK>>
  *claimId: text <<FK>>
  *articleId: text <<FK>>
  *text: text
  *vote: enum {pos, neg, neut}
}

entity "Claim review comment" as claimReviewComment {
  *_id : text <<generated>>
  --
  *userId : text <<FK>>
  *reviewId: text <<FK>>
  *text: text
  *proofUrls: array [text] 
}

user ||..o{ article
user ||..o{ inv
article }o..o{ claim
article ||..o{ rating
user ||..o{ review
user ||..o{ rating
claim ||..o{ review
claim }o..|| user
claim ||..o{ rating
review ||..o{ claimReviewComment
review ||..o{ rating
@enduml