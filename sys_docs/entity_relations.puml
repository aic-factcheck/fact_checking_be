@startuml
' hide the spot
hide circle

' avoid problems with angled crows feet
skinparam linetype ortho

entity "User" as user {
  *_id : string <<generated>>
  --
  *email : text
  *password : text
  *firstName : text
  *lastName: text
  *services : { G+, FB }
  *role : enum
  *picture : text
  *invitedBy: text <<FK>>
  *nReviews: number
  --
  *nPositiveVotes: number
  *positiveVotes: array <<userId>>
  *nNegativeVotes: number
  *negativeVotes: array <<userId>>
}

entity "Invitation" as inv {
  *_id : string <<generated>>
  --
  *invitedBy : text <<FK>>
  *invitedEmail: text
  *createdAt: date
  *verificationCode: Number
  *isValid: Boolean
  --
  - TTL 48 hours
}

entity "Article" as article {
  *_id : text <<generated>>
  --
  *addedBy : text <<FK>>
  *text : text
  *sourceUrl: text
  *sourceType : enum
  *language : text
  --
  *nPositiveVotes: number
  *positiveVotes: array <<userId>>
  *nNegativeVotes: number
  *negativeVotes: array <<userId>>
}

entity "Claim" as claim {
  *_id : text <<generated>>
  --
  *priority: number
  *addedBy: text <<FK>>
  *articleId : text <<FK>>
  *text : text
  --
  *nPositiveVotes: number
  *positiveVotes: array <<userId>>
  *nNeutralVotes: number
  *neutralVotes: array <<userId>>
  *nNegativeVotes: number
  *negativeVotes: array <<userId>>
}

entity "Review" as review {
  *_id : text <<generated>>
  --
  *userId : text <<FK>>
  *claimId: text <<FK>>
  *text: text
  *vote: enum {pos, neg, neut}
  --
  *nUpvotes: number
  *upvotes: array <<userId>>
  *nDownvotes: number
  *downvotes: array <<userId>>
}

entity "Claim review comment" as claimReviewComment {
  *_id : text <<generated>>
  --
  *userId : text <<FK>>
  *reviewId: text <<FK>>
  *text: text
  *proofUrls: array [text] 
}

user ||..o{ article
user ||..o{ inv
article ||..o{ claim
user ||..o{ review
claim ||..o{ review
claim }o..|| user
review ||..o{ claimReviewComment
@enduml